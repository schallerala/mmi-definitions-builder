\input{../preamble.tex}
\begin{document}
\setcounter{section}{6}
\setcounter{subsection}{4}
\setcounter{dfn}{10}


The proof uses the notion of a \emph{leftmost derivation} of a word in a context-free grammar.
A leftmost derivation is characterized by the property that at each step a production rule is applied to the leftmost variable in the current word.
In other words, the derivation
\[
\label{eqn:LMDerivation}
S = \alpha_0 \Rightarrow \alpha_1 \Rightarrow \cdots \Rightarrow \alpha_m \Rightarrow w
\]
is leftmost if, when we represent $\alpha_i$ as
\[
\alpha_i = u_i A_i \gamma_i, \quad u_i \in T^*,\, A_i \in V, \gamma_i \in (T \cup V)^*,
\]
then $\alpha_{i+1}$ comes from a production $A_i \to \beta_i$:
\begin{equation}
\label{eqn:Leftmost}
\alpha_i = u_i A_i \gamma_i \Rightarrow u_i \beta_i \gamma_i = u_{i+1} \gamma_{i+1} = \alpha_{i+1}.
\end{equation}
(This means in particular that $u_i$ is a prefix of $u_{i+1}$.)

A leftmost derivation always exists: it can be obtained from a derivation tree by the depth-first traversal.

\begin{proof}[Proof of Theorem \ref{thm:CFLtoPDA}]
Let $G = (V, T, P, S)$ be a context-free grammar such that $L = L(G)$.
We construct a PDA that simulates leftmost derivations of words in $G$ and accepts them by the empty stack.

The PDA will have the following structure:
\[
M = (\{q\}, T, T \cup V, \delta, q, S, \emptyset).
\]
(
It has only one state, thus everything is about changing the stack content.
The transition rules are as follows:
\[
\delta(q, \epsilon, A) = \{(q, \beta) \mid (A \to \beta) \in P\}, \quad \delta(q, a, a) = (q, \epsilon).
\]
In other words,
\begin{align}
(q, w, A\gamma) &\specialvdash{M}{} (q, w, \beta\gamma) \text{ whenever } (A \to \beta) \in P \label{eqn:FirstRule}\\
(q, aw, a\beta) &\specialvdash{M}{} (q, w, \beta) \label{eqn:SecondRule}
\end{align}
Let us show that $M$ accepts all words generated by $G$.
From the definition of a leftmost derivation of $w$ it is clear that each $u_i$ is a prefix of $w$: $w = u_i v_i$.
The transition rules allow to transform the ID $(q, v_i, A_i\gamma_i)$ to $(q, v_{i+1}, A_{i+1}\gamma_{i+1})$:
\[
(q, v_i, A_i\gamma_i) \specialvdash{M}{} (q, v_i, \beta_i\gamma_i) \specialvdash{M}{*} (q, v_{i+1}, A_{i+1}\gamma_{i+1}).
\]
First, the rule \eqref{eqn:FirstRule} is applied, and then a sequence (maybe empty) of rules \eqref{eqn:SecondRule}.
Going over $i$ from $0$ to $m$ one transforms $(q, w, S)$ to $(q, \epsilon, \epsilon)$.

Conversely, emptying the stack with the help of the rules \eqref{eqn:FirstRule} and \eqref{eqn:SecondRule}
can be interpreted as a derivation of a word in the grammar $G$.
\end{proof}


\end{document}